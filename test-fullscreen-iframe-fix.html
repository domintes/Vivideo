<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Fullscreen & Iframe Fix - Vivideo</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #111;
            font-family: Arial, sans-serif;
            color: white;
        }
        
        .test-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .test-video {
            width: 800px;
            height: 450px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #f9ca24);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            position: relative;
        }
        
        .fullscreen-btn {
            position: absolute;
            bottom: 10px;
            right: 10px;
            padding: 10px 20px;
            background: rgba(0, 0, 0, 0.8);
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            font-size: 14px;
        }
        
        .fullscreen-btn:hover {
            background: rgba(0, 0, 0, 0.9);
        }
        
        .test-info {
            background: #222;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .test-info h2 {
            color: #4ecdc4;
            margin-top: 0;
        }
        
        .iframe-container {
            border: 2px solid #333;
            border-radius: 8px;
            overflow: hidden;
            margin: 20px 0;
        }
        
        .iframe-test {
            width: 100%;
            height: 400px;
            border: none;
        }
        
        .test-results {
            background: #333;
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
        }
        
        .success {
            color: #4ecdc4;
        }
        
        .warning {
            color: #f9ca24;
        }
        
        .error {
            color: #ff6b6b;
        }
        
        video {
            max-width: 100%;
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <div class="test-info">
        <h2>üé¨ Fullscreen & Iframe Fix Test - Vivideo Extension</h2>
        <p><strong>Test Instructions:</strong></p>
        <ol>
            <li><strong>Fullscreen Test:</strong> Click fullscreen button on video below or press F11 on page</li>
            <li><strong>Panel Access:</strong> Use Alt+V to open Vivideo panel in fullscreen mode</li>
            <li><strong>Iframe Test:</strong> Check that only ONE panel appears (not multiple)</li>
            <li><strong>Video Filters:</strong> Adjust filters and see them work in fullscreen</li>
            <li><strong>Exit Fullscreen:</strong> Verify panel returns to normal position</li>
        </ol>
    </div>

    <div class="test-container">
        <h3>üñ•Ô∏è Main Page Video (Should show Vivideo panel)</h3>
        <div class="test-video" id="mainVideo">
            <span>Click for Fullscreen Test</span>
            <button class="fullscreen-btn" onclick="enterFullscreen('mainVideo')">‚õ∂ Fullscreen</button>
        </div>
        
        <video controls autoplay muted loop style="max-width: 600px;">
            <source src="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4" type="video/mp4">
            <source src="https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_1mb.mp4" type="video/mp4">
            Your browser does not support the video tag.
        </video>
    </div>

    <div class="iframe-container">
        <h3>üì¶ Iframe Test (Should NOT create duplicate panels)</h3>
        <p>This iframe contains video content. With the fix, it should NOT create a separate Vivideo panel:</p>
        <iframe class="iframe-test" src="data:text/html,
        <!DOCTYPE html>
        <html>
        <head>
            <style>
                body { margin: 20px; background: %23222; color: white; font-family: Arial; }
                .iframe-video { width: 300px; height: 200px; background: linear-gradient(135deg, %23e74c3c, %239b59b6); 
                               display: flex; align-items: center; justify-content: center; border-radius: 8px; }
            </style>
        </head>
        <body>
            <h3>üé• Video inside Iframe</h3>
            <div class='iframe-video'>Iframe Video Content</div>
            <p>This iframe should NOT trigger a separate Vivideo panel.</p>
            <video controls muted style='width: 100%; max-width: 300px;'>
                <source src='https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4' type='video/mp4'>
            </video>
        </body>
        </html>
        "></iframe>
    </div>

    <div class="test-results">
        <h3>‚úÖ Expected Results:</h3>
        <div class="success">
            <p><strong>Fullscreen Mode:</strong></p>
            <ul>
                <li>Vivideo panel should be visible and accessible in fullscreen</li>
                <li>Panel should have enhanced contrast for better visibility</li>
                <li>Alt+V shortcut should work in fullscreen</li>
                <li>Filters should apply to fullscreen video</li>
            </ul>
        </div>
        <div class="success">
            <p><strong>Iframe Fix:</strong></p>
            <ul>
                <li>Only ONE Vivideo panel should appear on the page</li>
                <li>Panel should be on the main page, not inside iframe</li>
                <li>No duplicate panels or multiple instances</li>
                <li>Console should show "Skipping initialization in iframe/frame"</li>
            </ul>
        </div>
    </div>

    <div class="test-info">
        <h2>üîß Testing Checklist</h2>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
            <div>
                <h3>Fullscreen Tests:</h3>
                <ul>
                    <li>‚ñ° Panel visible in fullscreen mode</li>
                    <li>‚ñ° Alt+V works in fullscreen</li>
                    <li>‚ñ° Panel has proper z-index (visible above video)</li>
                    <li>‚ñ° Panel styling enhanced for fullscreen</li>
                    <li>‚ñ° Filters work on fullscreen video</li>
                    <li>‚ñ° Panel returns to normal position after exit</li>
                </ul>
            </div>
            <div>
                <h3>Iframe Tests:</h3>
                <ul>
                    <li>‚ñ° Only one panel visible on page</li>
                    <li>‚ñ° No panel inside iframe</li>
                    <li>‚ñ° Console shows iframe skip message</li>
                    <li>‚ñ° Panel controls main page videos only</li>
                    <li>‚ñ° No JavaScript errors</li>
                    <li>‚ñ° Extension works normally</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        function enterFullscreen(elementId) {
            const element = document.getElementById(elementId);
            if (element.requestFullscreen) {
                element.requestFullscreen();
            } else if (element.webkitRequestFullscreen) {
                element.webkitRequestFullscreen();
            } else if (element.mozRequestFullScreen) {
                element.mozRequestFullScreen();
            } else if (element.msRequestFullscreen) {
                element.msRequestFullscreen();
            }
        }

        // Monitor fullscreen changes
        document.addEventListener('fullscreenchange', () => {
            console.log('Fullscreen changed:', !!document.fullscreenElement);
        });

        // Test console logging
        console.log('Vivideo Test Page: Iframe and Fullscreen Test Loaded');
        
        // Check if we're in an iframe
        if (window !== window.top) {
            console.log('This script is running in an iframe');
        } else {
            console.log('This script is running in the main window');
        }
    </script>
</body>
</html>
